version: "{build}-{branch}"

# If we ever get a backlog larger than clone_depth, builds will fail
# spuriously. I do not think we will ever get 20 deep commits deep though.
clone_depth: 20


# build with MSBuild
build:
  project: .\StateMachine.sln          # path to Visual Studio solution or project
  parallel: true                        # enable MSBuild parallel builds
  verbosity: normal                     # MSBuild verbosity level {quiet|minimal|normal|detailed}

  - name: Run Unit Tests
    working-directory: .\x64\Debug
    run: ./TESTS.exe -s

test_script:
  - set CTEST_OUTPUT_ON_FAILURE=1
  - cmd: appveyorTestRunScript.bat
 
# Sadly we cannot use the standard "dimensions" based approach towards
# specifying the different builds, as there is no way to add one-offs
# builds afterwards. This means that we will painfully specify each
# build explicitly.
environment:
  matrix:     
    - FLAVOR: VS 2022 x64 Debug
      APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2022
      platform: x64
      configuration: Debug
      
